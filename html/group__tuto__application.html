<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>gKit2 light: écrire une application openGL</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">gKit2 light
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">écrire une application openGL</div>  </div>
</div><!--header-->
<div class="contents">
<p>cf <a class="el" href="tuto1_8cpp.html">tuto1.cpp</a></p>
<p>une application openGL est composée de plusieurs éléments :</p><ul>
<li>une fenêtre pour voir ce que l'on dessine,</li>
<li>un contexte openGL pour dessiner,</li>
<li>3 fonctions :<ul>
<li>init( ) pour créer les objets que l'on veut dessiner,</li>
<li>quit( ) pour détruire les objets openGL crées dans init( ), à la fermeture de l'application,</li>
<li><a class="el" href="group__objet3D.html#ga749ef04b579edc715d094c57395f7492" title="applique une texture a la surface de l&#39;objet. ne fonctionne que si les coordonnees de textures sont f...">draw( )</a> pour afficher / dessiner quelquechose.</li>
</ul>
</li>
</ul>
<p>ces 3 fonctions sont appelées dans le main.</p>
<p>La classe <a class="el" href="classApp.html" title="classe application. ">App</a> permet également d'écrire une application avec une conception légèrement différente mais avec les mêmes fonctionnalités. cf <a class="el" href="tuto7_8cpp.html" title="reprise de tuto6.cpp mais en derivant App::init(), App::quit() et bien sur App::render(). ">tuto7.cpp</a> pour un exemple.</p>
<h2>création de la fenêtre et du contexte openGL :</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="window_8h.html">window.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> init( ) { ... }</div>
<div class="line"><span class="keywordtype">int</span> quit( ) { ... }</div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="group__objet3D.html#ga749ef04b579edc715d094c57395f7492">draw</a>( ) { ... }</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main( <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv )</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// etape 1 : creer la fenetre</span></div>
<div class="line">    Window window= <a class="code" href="group__application.html#gaa2ccc0668e24cd3b5ed182a7ae81d823">create_window</a>(1024, 640);    <span class="comment">// indiquer les dimensions de la fenêtre</span></div>
<div class="line">    <span class="keywordflow">if</span>(window == NULL) </div>
<div class="line">        <span class="keywordflow">return</span> 1;       <span class="comment">// erreur lors de la création de la fenetre ou de l&#39;init de SDL2</span></div>
<div class="line">    </div>
<div class="line">    <span class="comment">// etape 2 : creer un contexte opengl pour pouvoir dessiner</span></div>
<div class="line">    Context context= <a class="code" href="group__application.html#gaf0c843316a3eb7de396865b4829b5fd0">create_context</a>(window);</div>
<div class="line">    <span class="keywordflow">if</span>(context == NULL) </div>
<div class="line">        <span class="keywordflow">return</span> 1;       <span class="comment">// erreur lors de la creation du contexte opengl</span></div>
<div class="line">    </div>
<div class="line">    <span class="comment">// etape 3 : creation des objets openGL de l&#39;application</span></div>
<div class="line">    <span class="keywordflow">if</span>(init() &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="group__application.html#ga6efbb9298a8f73b9a17959b56ec20267">printf</a>(<span class="stringliteral">&quot;[error] init failed.\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// etape 4 : affichage de l&#39;application, tant que la fenetre n&#39;est pas fermee. ou que draw() ne renvoie pas 0</span></div>
<div class="line">    <span class="comment">// appelle draw( ) pour dessiner une nouvelle image, 60 fois par seconde.</span></div>
<div class="line">    <a class="code" href="group__application.html#ga54fba9d19011ba2310656651ce142ced">run</a>(window, <a class="code" href="group__objet3D.html#ga749ef04b579edc715d094c57395f7492">draw</a>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// etape 5 : nettoyage</span></div>
<div class="line">    quit(); <span class="comment">// detruire les objets openGL crees par l&#39;application</span></div>
<div class="line">    <a class="code" href="group__application.html#ga94b13fc6c0433955adf43e205964a9b1">release_context</a>(context);</div>
<div class="line">    <a class="code" href="group__application.html#ga50dd2becf25032523f9d203845d50a3e">release_window</a>(window);</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p>ces fonctions sont documentées dans <a class="el" href="window_8h.html">window.h</a> et utilisent la librairie <a href="http://libsdl.org">SDL2</a> pour rester portable sur les mêmes systèmes qu'openGL.</p>
<p>il est aussi possible d'utiliser directement sdl, sans passer par ces fonctions prédéfinies. une application crée une fenêtre et traite les evènements clavier, souris et d'autres générés par le système d'exploitation. la fonction <a class="el" href="group__application.html#ga54fba9d19011ba2310656651ce142ced" title="fonction principale. gestion des evenements et appel de la fonction draw de l&#39;application. ">run( )</a> les traite pour vous.</p>
<p>dans la mesure du possible, les fonctions de <a class="el" href="window_8h.html">window.h</a> ne dupliquent pas / n'abstraient pas les fonctionnalités de sdl2, vous pouvez les utiliser directement. par exemple :</p><ul>
<li>SDL_GetTicks() pour connaitre le temps écoulé depuis le lancement de l'application,</li>
<li>SDL_GetMouseState() pour récupérer la position de la souris et l'état de ses boutons.</li>
</ul>
<p><a class="el" href="window_8h.html">window.h</a> définit par contre des utilitaires pour simplifier l'écriture d'applications interactives. par exemple, si vous voulez modifier la position d'un objet en appuyant sur une touche, les fonctions <a class="el" href="group__application.html#gaab3200e25979a4c8db0238b880b8473d" title="renvoie l&#39;etat d&#39;une touche du clavier. cf la doc SDL2 pour les codes. ">key_state( )</a> et <a class="el" href="group__application.html#ga6dc30441deb49055fc010b25478aac80" title="desactive une touche du clavier. ">clear_key_state( )</a> permettent de le faire très simplement.</p>
<p>autre exemple d'utilisation : faire une capture d'écran de l'application</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="window_8h.html">window.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="texture_8h.html">texture.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="group__objet3D.html#ga749ef04b579edc715d094c57395f7492">draw</a>( )</div>
<div class="line">{</div>
<div class="line">    ...</div>
<div class="line">    <span class="keywordflow">if</span>(<a class="code" href="group__application.html#gaab3200e25979a4c8db0238b880b8473d">key_state</a>(<span class="charliteral">&#39;s&#39;</span>))</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="group__application.html#ga6dc30441deb49055fc010b25478aac80">clear_key_state</a>(<span class="charliteral">&#39;s&#39;</span>);</div>
<div class="line">        <a class="code" href="group__openGL.html#ga2301f05c4c29216bec5ee6cfe0455d00">screenshot</a>(<span class="stringliteral">&quot;screenshot.png&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    ...</div>
<div class="line">}</div>
</div><!-- fragment --><p>à quoi sert le <a class="el" href="group__application.html#ga6dc30441deb49055fc010b25478aac80" title="desactive une touche du clavier. ">clear_key_state( )</a> ? vu que <a class="el" href="group__objet3D.html#ga749ef04b579edc715d094c57395f7492" title="applique une texture a la surface de l&#39;objet. ne fonctionne que si les coordonnees de textures sont f...">draw( )</a> est appelée 60 fois par seconde, il est probable que la touche reste enfoncée pendant une bonne dixaine d'appels, reinitialiser l'état de la touche permet d'éviter d'enregistrer 10 fois l'image... </p>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jan 27 2017 09:25:26 for gKit2 light by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
